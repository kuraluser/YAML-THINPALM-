
<div>
    <form [formGroup]="roleDetailsForm" (submit)="saveRoleDetails()" *ngIf="roleDetailsForm">
        <div>
            <label for="user_role_name">{{'USER_ROLE_NAME'| translate }}</label>
            <input type="text" id="user_role_name" formControlName="roleName"/>
            <cpdss-portal-validation-error [errors]="fieldError('roleName')" [errorMessages]="errorMessages.roleName">
            </cpdss-portal-validation-error>
        </div>
        <div>
            <label for="user_role_description">{{'USER_ROLE_DESCRIPTION'| translate }}</label>
            <input type="text" id="user_role_description" formControlName="roleDescription"/>
            <cpdss-portal-validation-error  [errors]="fieldError('roleDescription')" [errorMessages]="errorMessages.roleDescription">
            </cpdss-portal-validation-error>
        </div>

    </form>
    <button (click)="saveRoleDetails()" id="user_role_save">{{'SAVE_BUTTON_ROLE_DETAILS'| translate}}</button>
    <button (click)="cancel()" id="user_role_cancel">{{'CANCEL_BUTTON_ROLE_DETAILS_LABEL'| translate}}</button>
</div>


<div>
    <h4>{{'ROLE_MAPPING'| translate }}</h4>
    <p>{{'ROLE_MAPPING_HEADING'| translate }}</p>
    <p-treeTable [value]="treeNode"  selectionMode="checkbox" [(selection)]="selectedNodes" (onNodeSelect)="nodeSelect($event,true)" (onNodeUnselect)="nodeSelect($event,false)">
        <ng-template pTemplate="body" let-rowNode  let-rowData="rowData">
            <tr>
                <td>
                    <p-treeTableToggler [rowNode]="rowNode"></p-treeTableToggler>
                    <p-treeTableCheckbox [value]="rowNode"></p-treeTableCheckbox>
                    {{rowData.name}}
                </td>
                <td></td>
                <td></td>
                <td></td>
                
                <ng-container *ngFor = "let col of cols">
                        <td [ttEditableColumn]="rowData" [ttEditableColumnField]="col.field">
                            <ng-container> 
                                {{col.header}}
                                <input type="checkbox"  [checked]="rowData[col.field]" (change)="checkboxChange($event,rowData, rowNode,col.field)" [disabled]="!rowData[col.isViewable]"/>
                            </ng-container> 
                           
                        </td>
                </ng-container>
            </tr>
        </ng-template>
    </p-treeTable>
</div>


<cpdss-portal-user-allocate (selectedUserDetails)="userSelected($event)" [userDetails]="userDetails" [selectedUser]="selectedUser"></cpdss-portal-user-allocate>
